<!DOCTYPE html>
<html lang="en">
<head>
    <title>Todos</title>

    <script type="module">
        import Navbar from "./navbar.js";
        import Footer from "./footer.js";

        document.addEventListener("DOMContentLoaded", async () => {

            // Redirect if user is not logged in
            if (localStorage.getItem("isLoggedIn") !== "true") {
                alert("Please login first");
                window.location.href = "login.html";
            }

            document.getElementById("navbar").innerHTML = Navbar();
            document.getElementById("footer").innerHTML = Footer();

            // Fetch todos
            const res = await fetch("https://jsonplaceholder.typicode.com/todos?_limit=20");
            const data = await res.json();

            const container = document.getElementById("todoContainer");

            data.forEach(todo => {
                const div = document.createElement("div");
                div.style = `
                    background:#FAF3DD;
                    padding:15px;
                    margin:10px;
                    border-radius:10px;
                    box-shadow:0 0 5px rgba(0,0,0,0.1);
                `;
                div.innerHTML = `
                    <h3 style="color:#5E548E;">${todo.title}</h3>
                    <p>Status: <strong>${todo.completed ? "Completed ✔" : "Not Completed ❌"}</strong></p>
                `;
                container.appendChild(div);
            });
        });
    </script>

</head>

<body style="background:#FFFDF7; font-family:Arial;">

    <div id="navbar"></div>

    <h2 style="text-align:center; color:#5E548E;">Your Todos</h2>

    <div id="todoContainer" style="width:80%; margin:20px auto;"></div>

    <div id="footer"></div>

</body>
</html>
